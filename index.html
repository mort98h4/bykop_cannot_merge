<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="style.css">
    <style>
        main {
            background-color: white;
        }

        .fact {
            width: 100vw;
            height: 100vh;
            background-size: cover;
            background-position: center;
        }
    </style>
</head>

<body>
    <!-- Splashsektion med infografik -->
    <section id="splash_index">
        <div class="splash_section_top">
            <div class="arrow_left"></div>
            <div class="splash_icon1">
                <img src="" alt="">
            </div>
            <div class="splash_icon2">
                <img src="" alt="">
            </div>
            <div class="splash_icon3">
                <img src="" alt="">
            </div>
            <div class="splash_icon4">
                <img src="" alt="">
            </div>
            <div class="character1"></div>
            <div class="character2"></div>
            <div class="character3"></div>
            <div class="skyline"></div>
            <div class="arrow_right"></div>
        </div>
        <div class="splash_index_bottom">
            <div class="round_bg"></div>
            <div class="splash_text">
                <h2></h2>
                <p></p>
                <h4 class="splash_button"></h4>
            </div>
        </div>
    </section>
    <main>
        <!-- Section med facts -->
        <section id="facts">
        </section>
        <!-- Section med kampagnevideoen -->
        <section id="about_index">
        </section>

        <!-- Templates -->
        <template id="facts_template">
            <article class="fact">
                <h3></h3>
                <p></p>
            </article>
        </template>
    </main>
    <script src="script.js"></script>
    <script>
        "use strict"

        // Variabler
        let theIcons;
        let theFacts;
        let thePage;

        // Venter på at DOM'en er indlæst
        document.addEventListener("DOMContentLoaded", start);

        // Henter ikoner og tilhørende tekst fra WP
        async function start() {
            console.log("start");
            let url = "http://mortengross.dk/kea/10_eksamen_2_sem/bykop/wordpress/wp-json/wp/v2/splash_icon";
            let jsonData = await fetch(url);
            theIcons = await jsonData.json();
            console.log(theIcons);
            showTheSplashIcons();
            filterContent("101");
        }

        function showTheSplashIcons() {
            console.log("getTheSplashIcons");

            // Ikonerne sættes ind i splashsektionen
            document.querySelector(".splash_icon1 img").src = theIcons[3].image.guid;
            document.querySelector(".splash_icon2 img").src = theIcons[2].image.guid;
            document.querySelector(".splash_icon3 img").src = theIcons[1].image.guid;
            document.querySelector(".splash_icon4 img").src = theIcons[0].image.guid;

            document.querySelector(".splash_icon1").dataset.id = theIcons[3].id;
            document.querySelector(".splash_icon2").dataset.id = theIcons[2].id;
            document.querySelector(".splash_icon3").dataset.id = theIcons[1].id;
            document.querySelector(".splash_icon4").dataset.id = theIcons[0].id;
            document.querySelector(".splash_icon1").addEventListener("click", buttonClick);
            document.querySelector(".splash_icon2").addEventListener("click", buttonClick);
            document.querySelector(".splash_icon3").addEventListener("click", buttonClick);
            document.querySelector(".splash_icon4").addEventListener("click", buttonClick);
            getTheFacts();
        }

        function buttonClick() {
            console.log("ID", this.dataset.id);
            filterContent(this.dataset.id);
        }
        // Indholdet fra WP filtres og sættes ind i DOM'en
        function filterContent(theFilter) {
            if (theFilter == "101") {
                document.querySelector(".splash_text h2").textContent = theIcons[3].title.rendered;
                document.querySelector(".splash_text p").innerHTML = theIcons[3].description;
                document.querySelector(".splash_text h4").textContent = theIcons[3].button;
            } else if (theFilter == "102") {
                document.querySelector(".splash_text h2").textContent = theIcons[2].title.rendered;
                document.querySelector(".splash_text p").innerHTML = theIcons[2].description;
                document.querySelector(".splash_text h4").textContent = theIcons[2].button;
            } else if (theFilter == "103") {
                document.querySelector(".splash_text h2").textContent = theIcons[1].title.rendered;
                document.querySelector(".splash_text p").innerHTML = theIcons[1].description;
                document.querySelector(".splash_text h4").textContent = theIcons[1].button;
            } else if (theFilter == "105") {
                document.querySelector(".splash_text h2").textContent = theIcons[0].title.rendered;
                document.querySelector(".splash_text p").innerHTML = theIcons[0].description;
                document.querySelector(".splash_text h4").textContent = theIcons[0].button;
            }
        }

        // Henter facts og tilhørende tekst fra WP
        async function getTheFacts() {
            console.log("getTheFacts");
            let url = "http://mortengross.dk/kea/10_eksamen_2_sem/bykop/wordpress/wp-json/wp/v2/frontpage_fact";
            let jsonData = await fetch(url);
            theFacts = await jsonData.json();
            console.log(theFacts);
            getThePage();
            showTheFacts();
        }

        // Henter forsiden fra WP
        async function getThePage() {
            console.log("getThePage");
            let url = "http://mortengross.dk/kea/10_eksamen_2_sem/bykop/wordpress/wp-json/wp/v2/pages/9";
            let jsonData = await fetch(url);
            thePage = await jsonData.json();
            console.log(thePage);

            document.querySelector(".splash_index_bottom").style.backgroundImage = `url(${thePage.splash_image.guid})`;
            document.querySelector("#about_index").innerHTML = thePage.content.rendered;
        }

        // Viser factsne i DOM'en
        function showTheFacts() {
            console.log("showTheFacts");

            let dest = document.querySelector("#facts");
            let temp = document.querySelector("#facts_template");

            // Tømmer dest for indhold
            dest.innerHTML = "";

            // Looper igennem de enkelte facts
            theFacts.forEach(fact => {
                // Definerer klonen
                let clone = temp.cloneNode(true).content;

                // Indholdet hentes fra WP og placeres i klonen
                clone.querySelector(".fact").style.backgroundImage = `url(${fact.image.guid})`;
                clone.querySelector("h3").textContent = fact.title.rendered;
                clone.querySelector("p").innerHTML = fact.description;

                // Sætter hver enkelt klon ind i DOM'en
                dest.appendChild(clone);
            })
        }
    </script>
</body></html>
